# 03
## 数据库 联合查询 (并非 join)
> 下面以 postgresql 为例

province 表
|id:Integer|gb_code:CHAR(6)|name:CHAR(128)|geom:geometry|
| - | - | - | - |

commit 表
|id:Integer|commit_user_id:Integer|img_uuid:Text|commit_time:Integer|gps:geometry|
| - | - | - | - | -|

查询在湖北省内的所有 commit
```
select * from commit as c, province as p where p.gb_code = '420000' and ST_Contains(p.geom, c.gps);
```
# 06
## python flask 国际化
- https://blog.51cto.com/riven/2364872

```
from flask import Flask, request, jsonify

from flask_babel import Babel, gettext as _

app = Flask(__name__)
babel = Babel(app)

LANGUAGES = {
        "zh": "Chinese",
        "en": "English",
        "ja": "Japanese"
}

@babel.localeselector
def get_locale():
    return request.accept_languages.best_match(LANGUAGES.keys())


@app.route('/')
def hello():
    day = _("Saturday")
    r_json = {"status": 0, "msg": day, }
    return jsonify(r_json)


if __name__ == '__main__':
    app.run(host="0.0.0.0", port=9001, debug=True)

```

- 生成翻译文件
```
os.system("pybabel extract -F babel.cfg -o messages.pot .")
os.system("pybabel update -i messages.pot -d translations -l zh")
```
- 编辑翻译文件后, 生成二进制文件
```
os.system("pybabel compile -d translations")
```
- babel.cfg
```
[python: **.py]
[jinja2: **/templates/**.html]
extensions=jinja2.ext.autoescape,jinja2.ext.with_
```